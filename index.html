<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•µì‹¬ ê°„í˜¸ìˆ ê¸° í•™ìŠµ í”Œë«í¼ (LAMP)</title>
    <!-- ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* --- ê³µí†µ ìŠ¤íƒ€ì¼ --- */
        body { font-family: 'Inter', sans-serif; background-color: #f7f9fc; }
        .container { max-width: 800px; margin: 0 auto; }
        .skill-item { transition: all 0.3s ease; }
        .skill-item:hover { box-shadow: 0 10px 15px 3px rgba(0, 0, 0, 0.1), 0 4px 6px 2px rgba(0, 0, 0, 0.05); transform: translateY(-2px); }
        
        /* ì‹œì‘ ë²„íŠ¼ ì• ë‹ˆë©”ì´ì…˜ */
        .start-button { animation: pulse-shadow 2s infinite; }
        @keyframes pulse-shadow {
            0% { box-shadow: 0 0 0 0 rgba(79, 70, 229, 0.4) }
            70% { box-shadow: 0 0 0 10px rgba(79, 70, 229, 0) }
            100% { box-shadow: 0 0 0 0 rgba(79, 70, 229, 0) }
        }
        
        /* ì´ë¡ ì  ê·¼ê±° (Rationale) í‘œì‹œ ì „í™˜ */
        .rationale-container {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-in-out, padding 0.4s ease-in-out;
        }
        .rationale-container.visible {
            max-height: 200px; 
            padding-bottom: 0.75rem;
            padding-top: 0.5rem;
        }
        
        /* ì˜¤ë””ì˜¤ ì¬ìƒ ì‹œ UI ê°•ì¡° */
        .audio-control-container.playing .single-play-btn,
        .audio-control-container.playing .sequential-play-btn {
            color: #ef4444; /* text-red-500 */
        }

        /* ê°œë³„ í•­ëª© í…ìŠ¤íŠ¸ ê°€ë¦¬ê¸° (ì•”ê¸° ëª¨ë“œ) - ìš”ì²­ ë°˜ì˜ */
        .checklist-item-text.blur-sm {
            color: transparent !important; /* í…ìŠ¤íŠ¸ ìƒ‰ìƒì„ íˆ¬ëª…í•˜ê²Œ ë³€ê²½ */
            text-shadow: 0 0 5px rgba(100, 100, 100, 0.4); /* í…ìŠ¤íŠ¸ê°€ ìˆìŒì„ ë³´ì—¬ì£¼ëŠ” ì•½ê°„ì˜ ê·¸ë¦¼ì ì¶”ê°€ */
            user-select: none; /* ë“œë˜ê·¸ ë°©ì§€ */
        }
        .checklist-item-text {
            transition: all 0.3s ease;
        }
    </style>
    <!-- ì• í”Œë¦¬ì¼€ì´ì…˜ í•µì‹¬ ë¡œì§ -->
    <script type="module">
        // --- Firestore ëª¨ë“ˆ ì„í¬íŠ¸ ---
        import { getFirestore, onSnapshot, collection, query, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- ì „ì—­ ìƒìˆ˜ ë° ì´ˆê¸° ìƒíƒœ ---
        window.currentUserId = null; 
        const VIDEO_URL = "https://yswpub3.synology.me/smspdf/revision2023_song_fundamentalsofnursing_video/2023_QR_11.mp4";
        
        // --- GEMINI API ì„¤ì • ---
        const API_KEY = "AIzaSyDgmHHstNQP8vqNhHPAt6_joJHLVf3v7vo"; 
        const API_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent";
        
        // --- ìˆ ê¸° ëª©ë¡ ë°ì´í„° ---
        const CORE_SKILLS = [
            { name: "í™œë ¥ì§•í›„ ì¸¡ì •", difficulty: "í•˜", linkId: "vital-signs", emoji: "ğŸŒ¡" },
            { name: "ê²½êµ¬íˆ¬ì•½", difficulty: "í•˜", linkId: "mock", emoji: "ğŸ’Š" },
            { name: "ê·¼ìœ¡ì£¼ì‚¬", difficulty: "ì¤‘", linkId: "mock", emoji: "ğŸ’‰" },
            { name: "í”¼í•˜ì£¼ì‚¬(ê°„ì´ í˜ˆë‹¹ê²€ì‚¬ í¬í•¨)", difficulty: "ì¤‘", linkId: "mock", emoji: "ğŸ©¸" },
            { name: "í”¼ë‚´ì£¼ì‚¬(ì „ì™„ì˜ ë‚´ì¸¡ë©´)", difficulty: "ìƒ", linkId: "mock", emoji: "ğŸ“" },
            { name: "ì •ë§¥ìˆ˜ì•¡ ì£¼ì…(Infusionpump í˜¹ì€ syringepump ì‚¬ìš© í¬í•¨)", difficulty: "ìƒ", linkId: "mock", emoji: "ğŸ’§" },
            { name: "ìˆ˜í˜ˆìš”ë²•", difficulty: "ìƒ", linkId: "mock", emoji:"â¤ï¸" },
            { name: "ê°„í—ì  ìœ„ê´€ì˜ì–‘", difficulty: "ì¤‘", linkId: "mock", emoji: "ğŸ¥£" },
            { name: "ë‹¨ìˆœë„ë‡¨(Straight catheterization)", difficulty: "ì¤‘", linkId: "mock", emoji: "ğŸš½" },
            { name: "ìœ ì¹˜ë„ë‡¨(Indwelling catheterization)", difficulty: "ìƒ", linkId: "mock", emoji: "ğŸš°" },
            { name: "ë°°ì¶œê´€ì¥", difficulty: "ì¤‘", linkId: "mock", emoji: "ğŸš¿" },
            { name: "ë§ì´ˆì‚°ì†Œí¬í™”ë„(Pulse oximeter) ì¸¡ì •ê³¼ ì‹¬ì „ë„ ëª¨ë‹ˆí„°(EKG monitor) ì ìš©", difficulty: "í•˜", linkId: "mock", emoji: "ğŸ©º" },
            { name: "ë¹„ê°•ìºë‰¼ë¼ë¥¼ ì´ìš©í•œ ì‚°ì†Œìš”ë²•", difficulty: "í•˜", linkId: "mock", emoji: "ğŸŒ¬ï¸" },
            { name: "í¡ì¸(Suction)", difficulty: "ìƒ", linkId: "mock", emoji: "ğŸŒªï¸" },
            { name: "ê¸°ë³¸ ì‹¬íì†Œìƒìˆ  ë° ì œì„¸ë™ê¸° ì ìš©", difficulty: "ì¤‘", linkId: "mock", emoji: "âš¡" },
            { name: "í†µì¦ê´€ë¦¬", difficulty: "ì¤‘", linkId: "mock", emoji: "ğŸ¤•" },
            { name: "ìš•ì°½ê´€ë¦¬ ë° ë‚™ìƒì˜ˆë°©ê°„í˜¸", difficulty: "í•˜", linkId: "mock", emoji: "ğŸ©¹" },
            { name: "ë°°ì•¡ê´€ ê´€ë¦¬(JPë˜ëŠ” Hemovac)", difficulty: "ì¤‘", linkId: "mock", emoji: "ğŸ—‘ï¸" }
        ];

        // --- ìˆ ê¸° ë‹¨ê³„ í•™ìŠµ ë°ì´í„° (í™œë ¥ì§•í›„) ---
        const VITAL_SIGN_STEPS = [
            { id: 1, title: "ì¤€ë¹„ ë° í™˜ì í™•ì¸", procedure: "ë¬¼ê³¼ ë¹„ëˆ„ ë˜ëŠ” ì•Œì½”ì˜¬ ê¸°ë°˜ ì† ì†Œë…ì œë¥¼ ì´ìš©í•˜ì—¬ ì† ìœ„ìƒì„ ì‹¤ì‹œí•˜ê³ , í™˜ìì—ê²Œ ì²´ì˜¨, ë§¥ë°•, í˜¸í¡, í˜ˆì•• ì¸¡ì •ì„ ì„¤ëª…í•œ í›„ ë™ì˜ë¥¼ êµ¬í•˜ê³  í•„ìš”í•œ ì¥ë¹„ë¥¼ ì¤€ë¹„í•œë‹¤.", terms: ["Hand Hygiene", "Informed Consent"] },
            { id: 2, title: "ì²´ì˜¨ ì¸¡ì • (Temperature)", procedure: "êµ¬ê°•, ì•¡ì™€, ê³ ë§‰, ë˜ëŠ” ì§ì¥ ì²´ì˜¨ ì¤‘ ì ì ˆí•œ ë°©ë²•ì„ ì„ íƒí•˜ê³  ì •í™•í•œ ì¸¡ì • ë¶€ìœ„ì— ì²´ì˜¨ê³„ë¥¼ ìœ„ì¹˜ì‹œí‚¨ë‹¤. ê²°ê³¼ëŠ” ì¦‰ì‹œ í™•ì¸í•˜ê³  ê¸°ë¡í•œë‹¤.", terms: ["Oral Temp", "Axillary Temp", "Tympanic Temp"] },
            { id: 3, title: "ë§¥ë°• ì¸¡ì • (Pulse)", procedure: "ìš”ê³¨ë™ë§¥(Radial artery)ì„ ì´‰ì§€í•˜ì—¬ ë§¥ë°•ì˜ ê·œì¹™ì„±ê³¼ ê°•ë„ë¥¼ í™•ì¸í•˜ê³ , 1ë¶„ ë™ì•ˆ ì¸¡ì •í•œë‹¤. ë§¥ë°•ìˆ˜ê°€ ë¶ˆê·œì¹™í•  ê²½ìš° ì‹¬ì²¨ ë§¥ë°•ì„ ì¸¡ì •í•œë‹¤.", terms: ["Radial Pulse", "Apical Pulse", "Tachycardia", "Bradycardia"] },
            { id: 4, title: "í˜¸í¡ ì¸¡ì • (Respiration)", procedure: "ë§¥ë°• ì¸¡ì • í›„ ì†ì„ ë–¼ì§€ ì•Šê³  í™˜ìì—ê²Œ ì•Œë¦¬ì§€ ì•Šì€ ìƒíƒœë¡œ ê°€ìŠ´ì˜ ì˜¤ë¥´ë‚´ë¦¼ì„ ê´€ì°°í•˜ë©° 1ë¶„ ë™ì•ˆ ì¸¡ì •í•œë‹¤. ê¹Šì´ì™€ ë¦¬ë“¬ë„ í•¨ê»˜ í™•ì¸í•œë‹¤.", terms: ["Dyspnea", "Tachypnea", "Bradypnea"] },
            { id: 5, title: "í˜ˆì•• ì¸¡ì • (Blood Pressure)", procedure: "ëŒ€ìƒìë¥¼ ì•ˆì •ì‹œí‚¤ê³  íŒ”ì„ ì‹¬ì¥ ë†’ì´ì— ë‘”ë‹¤. ì»¤í”„ë¥¼ ì •í™•íˆ ê°ê³  ì²­ì§„ê¸°ë¡œ ì‹¬ìŒ(Korotkoff sound)ì„ ë“¤ìœ¼ë©´ì„œ ìˆ˜ì¶•ê¸°/ì´ì™„ê¸° í˜ˆì••ì„ ì¸¡ì •í•œë‹¤. ì¸¡ì • í›„ ì»¤í”„ì˜ ê³µê¸°ë¥¼ ì™„ì „íˆ ì œê±°í•œë‹¤.", terms: ["Systolic BP", "Diastolic BP", "Hypertension", "Hypotension"] },
            { id: 6, title: "ê¸°ë¡ ë° ë§ˆë¬´ë¦¬", procedure: "ì¸¡ì •ëœ í™œë ¥ì§•í›„ ê²°ê³¼ë¥¼ ì¦‰ì‹œ ê¸°ë¡í•˜ê³ , ì‚¬ìš©í•œ ì¥ë¹„ë¥¼ ì •ë¦¬í•˜ë©° ì† ìœ„ìƒìœ¼ë¡œ ë§ˆë¬´ë¦¬í•œë‹¤. íŠ¹ì´ì‚¬í•­ì„ í™˜ìì—ê²Œ ì•Œë¦¬ê³  í•„ìš”í•œ ì¶”ê°€ ì¡°ì¹˜ë¥¼ ì·¨í•œë‹¤.", terms: ["Charting", "Baseline Data"] }
        ];

        // --- ì „ì²´ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë°ì´í„° (í™œë ¥ì§•í›„) ---
        const VITAL_SIGN_CHECKLIST_DATA = [
            { item: "ë¬¼ê³¼ ë¹„ëˆ„ë¡œ ì†ìœ„ìƒì„ ì‹¤ì‹œí•œë‹¤.", rationale: "ë¯¸ìƒë¬¼ ì „íŒŒë¥¼ ë°©ì§€í•¨." },
            { item: "í•„ìš”í•œ ë¬¼í’ˆì„ ì¤€ë¹„í•˜ê³ , ì‘ë™ì—¬ë¶€ë¥¼ í™•ì¸í•œë‹¤.(ì²­ì§„ê¸°, ì²´ì˜¨ê³„, í˜ˆì••ê³„)", rationale: "ì •í™•í•œ ì¸¡ì •ì„ ë³´ì¥í•˜ê³  ìˆ ê¸° ì‹œê°„ì„ ë‹¨ì¶•í•©ë‹ˆë‹¤." },
            { item: "ì¤€ë¹„í•œ ë¬¼í’ˆì„ ê°€ì§€ê³  ëŒ€ìƒìì—ê²Œ ê°€ì„œ ê°„í˜¸ì‚¬ ìì‹ ì„ ì†Œê°œí•œë‹¤.", rationale: "í™˜ìì˜ ë¶ˆì•ˆì„ ê°ì†Œì‹œí‚¤ê³  ë¼í¬(Rapport)ë¥¼ í˜•ì„±í•©ë‹ˆë‹¤." },
            { item: "ì†ì†Œë…ì œë¡œ ì†ìœ„ìƒì„ ì‹¤ì‹œí•œë‹¤.", rationale: "ê°ì—¼ ê´€ë¦¬ë¥¼ ìœ„í•œ ì¶”ê°€ì ì¸ ì˜ˆë°© ì¡°ì¹˜ì…ë‹ˆë‹¤." },
            { item: "ëŒ€ìƒìì˜ ì´ë¦„ì„ ê°œë°©í˜•ìœ¼ë¡œ ì§ˆë¬¸í•˜ì—¬ ëŒ€ìƒìë¥¼ í™•ì¸í•˜ê³ , ì…ì›íŒ”ì°Œì™€ í™˜ìë¦¬ìŠ¤íŠ¸(ë˜ëŠ” ì²˜ë°©ì§€)ë¥¼ ëŒ€ì¡°í•˜ì—¬ ëŒ€ìƒì(ì´ë¦„, ë“±ë¡ë²ˆí˜¸)ë¥¼ í™•ì¸í•œë‹¤.", rationale: "ì•ˆì „ì„ ìœ„í•´ íˆ¬ì•½ ë° ì²˜ì¹˜ ì „ ì •í™•í•œ ëŒ€ìƒì í™•ì¸ì€ í•„ìˆ˜ì…ë‹ˆë‹¤. (ê°œë°©í˜• ì§ˆë¬¸)" },
            { item: "ëŒ€ìƒìì—ê²Œ ì²´ì˜¨, ë§¥ë°•, í˜¸í¡, í˜ˆì••ì„ ì¸¡ì •í•˜ëŠ” ëª©ì ê³¼ ì ˆì°¨ë¥¼ ì„¤ëª…í•œë‹¤.", rationale: "í™˜ìì˜ í˜‘ì¡°ë¥¼ ì–»ê³ , ë¶ˆì•ˆì„ ì™„í™”í•˜ë©°, ì•Œ ê¶Œë¦¬ë¥¼ ì¶©ì¡±ì‹œí‚µë‹ˆë‹¤." },
            { item: "[ì•¡ì™€ ì²´ì˜¨ê³„] ì „ìì²´ì˜¨ê³„ë¥¼ êº¼ë‚´ì–´ ëë¶€ë¶„ì„ ì†Œë…ì†œìœ¼ë¡œ ë‹¦ì€ í›„ ê²¨ë“œë‘ì´ ì¤‘ì•™ì— ì‚½ì…í•˜ì—¬ ì²´ì˜¨ê³„ê°€ ë¹ ì§€ì§€ ì•Šë„ë¡ ì§€ì§€í•œë‹¤.", rationale: "ì²´ì˜¨ê³„ì˜ ì •í™•í•œ ì†Œë…ê³¼ ì¸¡ì • ë¶€ìœ„ì˜ ì •í™•í•œ ìœ„ì¹˜ëŠ” ì •í™•í•œ ì²´ì˜¨ ì¸¡ì •ì„ ìœ„í•´ ì¤‘ìš”í•©ë‹ˆë‹¤." },
            { item: "[ì•¡ì™€ ì²´ì˜¨ê³„] ëŒ€ìƒìì—ê²Œ ì²´ì˜¨ì´ ì¸¡ì •ë  ë•Œê¹Œì§€ ì²´ì˜¨ê³„ê°€ ìœ ì§€ë˜ë„ë¡ ì„¤ëª…í•œë‹¤.", rationale: "ì¸¡ì • ì‹œê°„ ë™ì•ˆ ì›€ì§ì„ì„ ìµœì†Œí™”í•˜ì—¬ ì˜¤ë¥˜ë¥¼ ë°©ì§€í•©ë‹ˆë‹¤." },
            { item: "[ê³ ë§‰ì²´ì˜¨ê³„] ìš©ê¸°ì—ì„œ íƒì¹¨ ë®ê°œë¥¼ êº¼ë‚¸ í›„ íƒì¹¨ ë®ê°œë¥¼ ê³ ë§‰ì²´ì˜¨ê³„ì— ë®ëŠ”ë‹¤.", rationale: "êµì°¨ ê°ì—¼ì„ ì˜ˆë°©í•˜ê³  ì¸¡ì •ì˜ ì •í™•ì„±ì„ ë†’ì…ë‹ˆë‹¤." },
            { item: "[ê³ ë§‰ì²´ì˜¨ê³„] ëŒ€ìƒìì˜ ë¨¸ë¦¬ë¥¼ í•œ ìª½ìœ¼ë¡œ ëŒë ¤ ì²´ì˜¨ì„ ì¸¡ì •í•  ê·€ë¥¼ ë…¸ì¶œ ì‹œí‚¨ í›„ ê·“ë°”í€´ë¥¼(ì„±ì¸ì˜ ê·“ë°”í€´ëŠ” í›„ìƒë°©ìœ¼ë¡œ ì†Œì•„ëŠ” í›„í•˜ë°©ìœ¼ë¡œ) ë‹¹ê¸´ ë‹¤ìŒ íƒì¹¨ì„ ë¶€ë“œëŸ½ê²Œ ì™¸ì´ë„ë¡œ ì‚½ì…í•˜ì—¬ ì²´ì˜¨ì„ ì¸¡ì •í•œë‹¤.", rationale: "ê³ ë§‰ì²´ì˜¨ê³„ì˜ íƒì¹¨ì„ ê³ ë§‰ìœ¼ë¡œ í–¥í•˜ê²Œ í•˜ì—¬ ì •í™•í•œ ì¤‘ì‹¬ì²´ì˜¨ì„ ì¸¡ì •í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤." },
            { item: "[ê³ ë§‰ì²´ì˜¨ê³„] íƒì¹¨ ë®ê°œë¥¼ ì œê±° í•œ í›„ì— ì²´ì˜¨ì„ ë©”ëª¨í•œë‹¤.", rationale: "ì‚¬ìš© í›„ ì¦‰ì‹œ ë®ê°œë¥¼ ì œê±°í•˜ì—¬ ì˜¤ì—¼ëœ ìƒíƒœë¥¼ ë°©ì§€í•©ë‹ˆë‹¤." },
            { item: "ì¸¡ì •ëœ ë§¥ë°•ê³¼ í˜¸í¡, ì²´ì˜¨ì„ ë©”ëª¨í•œë‹¤.", rationale: "ì˜¤ë¥˜ë¥¼ ë°©ì§€í•˜ê³  ê°„í˜¸ ê¸°ë¡ ì „ê¹Œì§€ ë°ì´í„°ë¥¼ ì„ì‹œë¡œ ë³´ì¡´í•©ë‹ˆë‹¤." },
            { item: "ëŒ€ìƒìì˜ íŒ”ì„ í¸í•œ ìì„¸ë¡œ ë†“ê³ , ëŒ€ìƒìì˜ ì´ë¶ˆì„ ë‚´ë ¤ ê°€ìŠ´ì´ ë³´ì´ë„ë¡ í•œë‹¤.", rationale: "í˜¸í¡ ì¸¡ì •ì„ ìš©ì´í•˜ê²Œ í•˜ê³  í™˜ìì˜ í¸ì•ˆí•¨ì„ ìœ ì§€í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤." },
            { item: "ì†ê°€ë½ìœ¼ë¡œ ìš”ê³¨ë™ë§¥ì„ ì°¾ì•„ì„œ ê·¸ ìœ„ì— ë†“ê³ , ë§¥ë°• ë¶€ìœ„ë¥¼ í™•ì¸í•œ í›„, ë§¥ë°•ì„ ì¸¡ì •í•œë‹¤. (ì²˜ìŒ ì…ì› ì‹œ) 1ë¶„ê°„ ë§¥ë°•ìˆ˜ë¥¼ ì¸¡ì •í•œë‹¤. (ì…ì› ì¤‘ ê·œì¹™ì ì„ì„ í™•ì¸í•œ í›„) 30ì´ˆ ë™ì•ˆ ë§¥ë°•ìˆ˜ë¥¼ ì¸¡ì •í•œ í›„ 2ë°°ë¥¼ í•œë‹¤.", rationale: "ì •í™•í•œ ë§¥ë°•ìˆ˜, ë¦¬ë“¬, ê°•ë„ë¥¼ íŒŒì•…í•˜ê³ . ë¶ˆê·œì¹™í•  ê²½ìš° ì˜¤ì°¨ë¥¼ ì¤„ì´ê¸° ìœ„í•´ 1ë¶„ ì „ì²´ë¥¼ ì¸¡ì •í•´ì•¼ í•©ë‹ˆë‹¤." },
            { item: "ë§¥ë°•ì„ ì¸¡ì •í•œ í›„ ë™ë§¥ì— ì†ì„ ê·¸ëŒ€ë¡œ ëŒ„ ì±„ë¡œ í˜¸í¡ì„ ì¸¡ì •í•œë‹¤. (ì²˜ìŒ ì…ì› ì‹œ) 1ë¶„ê°„ í˜¸í¡ìˆ˜ë¥¼ ì¸¡ì •í•œë‹¤. (ì…ì› ì¤‘) 30ì´ˆ ë™ì•ˆ í˜¸í¡ìˆ˜ë¥¼ ì¸¡ì •í•œ í›„ 2ë°°ë¥¼ í•œë‹¤.", rationale: "í˜¸í¡ì€ ì˜ì‹ì ì¸ ì¡°ì ˆì´ ê°€ëŠ¥í•˜ë¯€ë¡œ, í™˜ìê°€ í˜¸í¡ì„ ì˜ì‹í•˜ì§€ ì•Šë„ë¡ ë§¥ë°• ì¸¡ì • ì§í›„ ì¸¡ì •í•©ë‹ˆë‹¤." },
            { item: "ì²´ì˜¨ì´ ì¸¡ì •ë˜ë©´ ì²´ì˜¨ê³„ë¥¼ ë¹¼ê³ , ì†Œë…ì†œìœ¼ë¡œ ë‹¦ì€ í›„ ì²´ì˜¨ê³„ì˜ ì „ì›ì„ ë„ê³  ìš©ê¸°ì— ë„£ëŠ”ë‹¤.", rationale: "ì¥ë¹„ë¥¼ ì²­ê²°í•˜ê²Œ ìœ ì§€í•˜ê³  ì „ë ¥ ì†Œë¹„ë¥¼ ì¤„ì´ê¸° ìœ„í•¨ì…ë‹ˆë‹¤." },
            { item: "ëŒ€ìƒìê°€ í¸ì•ˆí•œ ìì„¸ë¥¼ ì·¨í•˜ê²Œ í•œ í›„, ëŒ€ìƒìì˜ íŒ”ì„ ì‹¬ì¥ê³¼ ê°™ì€ ë†’ì´ë¡œ ë†“ê³  íŒ”ì„ ë…¸ì¶œì‹œí‚¨ë‹¤.", rationale: "ì •í™•í•œ í˜ˆì•• ì¸¡ì •ì„ ìœ„í•´ ì»¤í”„ ìœ„ì¹˜ê°€ ì‹¬ì¥ ë†’ì´ì™€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤." },
            { item: "íŒ”ì˜¤ê¸ˆ ìƒì™„ë™ë§¥ 2~3cmìœ„ì— ì»¤í”„ì˜ bulbì— ì—°ê²°ëœ ì¤„ì´ ìƒì™„ë™ë§¥ê³¼ í‰í–‰ì´ ë˜ê²Œ ë†“ì´ë„ë¡ í•˜ê³  ì†ê°€ë½ í•˜ë‚˜ê°€ ë“¤ì–´ê°ˆ ì •ë„ì˜ ì—¬ìœ ë¥¼ ì£¼ê³  ê°ëŠ”ë‹¤.", rationale: "ì»¤í”„ì˜ ë¶€ì ì ˆí•œ ìœ„ì¹˜ëŠ” ì˜¤ì°¨ë¥¼ ìœ ë°œí•˜ë©°, ì ì ˆí•œ ë°€ì°©ì€ ì••ë ¥ì„ ì •í™•í•˜ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤." },
            { item: "ì°¸ê³ : í˜ˆì•• ì´ˆê¸° ì¸¡ì •ì„ ìœ„í•´ ìƒì™„ë™ë§¥ì„ ì´‰ì§€í•˜ì—¬ ë§¥ë°• ì†Œì‹¤ ì§€ì ì„ í™•ì¸í•œë‹¤. (30mmHg ë” ì˜¬ë¦¼)", rationale: "ì²­ì§„ì„ ì‹œì‘í•  ì••ë ¥ì„ ê²°ì •í•˜ì—¬ ì²­ì§„ìƒì˜ ì˜¤ì°¨ (Auscultatory Gap)ë¥¼ ì˜ˆë°©í•©ë‹ˆë‹¤." },
            { item: "í˜ˆì••ê³„ì˜ ì¡°ì ˆ ë°¸ë¸Œë¥¼ ì ê·¸ê³  ì••ë ¥ bulbë¥¼ ëˆŒëŸ¬ í˜ˆì••ê³„ì˜ ëˆˆê¸ˆì´ 160~200mmHgê¹Œì§€ ì˜¬ë¼ê°€ê²Œ ê³µê¸°ë¥¼ ë„£ëŠ”ë‹¤.", rationale: "ì¼ë°˜ì ìœ¼ë¡œ 160~200mmHgê¹Œì§€ ì••ë ¥ì„ ê°€í•˜ì—¬ ë™ë§¥ì„ ì™„ì „íˆ íì‡„ì‹œí‚µë‹ˆë‹¤." },
            { item: "ì¡°ì ˆ ë°¸ë¸Œë¥¼ ì²œì²œíˆ ì—´ì–´ 1ì´ˆì— 2mmHgì”© ëˆˆê¸ˆì„ ë‚´ë¦¬ë©´ì„œ ì²˜ìŒ ì†Œë¦¬ê°€ ë“¤ë¦¬ëŠ” ì§€ì ì˜ ëˆˆê¸ˆì„ ì½ì–´ì„œ ê¸°ì–µí•œë‹¤.", rationale: "ìˆ˜ì¶•ê¸° í˜ˆì••(Systolic BP)ì„ ì •í™•íˆ ì¸¡ì •í•˜ê¸° ìœ„í•´ ì••ë ¥ì„ ì²œì²œíˆ ë‚´ë¦½ë‹ˆë‹¤." },
            { item: "ì¡°ì ˆ ë°¸ë¸Œë¥¼ ì²œì²œíˆ ì—´ì–´ ì°¨ì¸° ì»¤í”„ì—ì„œ ê³µê¸°ë¥¼ ë¹¼ë©´ì„œ ì†Œë¦¬ê°€ ì—†ì–´ì§€ëŠ” ì§€ì ì˜ ëˆˆê¸ˆì„ ì½ì–´ì„œ ê¸°ì–µí•œë‹¤.", rationale: "ì´ì™„ê¸° í˜ˆì••(Diastolic BP)ì„ ì •í™•íˆ ì¸¡ì •í•˜ê¸° ìœ„í•´ ì†Œì‹¤ë˜ëŠ” ì§€ì ì„ í™•ì¸í•©ë‹ˆë‹¤." },
            { item: "ì¡°ì ˆ ë°¸ë¸Œë¥¼ ì™„ì „íˆ ì—´ì–´ ì»¤í”„ì—ì„œ ê³µê¸°ë¥¼ ì™„ì „íˆ ëº€ í›„ ì»¤í”„ë¥¼ í’€ì–´. í˜ˆì••ê³„ë¥¼ ì •ë¦¬í•œë‹¤.", rationale: "í˜ˆì•¡ ìˆœí™˜ì„ ë°©í•´í•˜ì§€ ì•Šê³  ì¥ë¹„ë¥¼ ë³´í˜¸í•©ë‹ˆë‹¤." },
            { item: "ëŒ€ìƒìì˜ í™˜ì˜ë¥¼ ì •ë¦¬í•œë‹¤. ì¸¡ì •ëœ í˜ˆì••ì„ ë©”ëª¨í•œë‹¤.", rationale: "í™˜ìì˜ í”„ë¼ì´ë²„ì‹œë¥¼ ì¡´ì¤‘í•˜ê³  ë‹¤ìŒ ê°„í˜¸ ê¸°ë¡ì„ ì¤€ë¹„í•©ë‹ˆë‹¤." },
            { item: "ì²­ì§„ê¸°ì˜ ê·€ê½‚ì´(ear piece)ì™€ íŒë§‰(diaphragm)ì„ ì†Œë…ì†œìœ¼ë¡œ ë‹¦ëŠ”ë‹¤. ë¬¼ê³¼ ë¹„ëˆ„ë¡œ ì†ìœ„ìƒì„ ì‹¤ì‹œí•œë‹¤. ê°„í˜¸ê¸°ë¡ì§€ì— í˜¸í¡, ì²´ì˜¨, ë§¥ë°•, í˜ˆì••ì¸¡ì •ì¹˜ë¥¼ ê¸°ë¡í•œë‹¤.", rationale: "ê°ì—¼ ê´€ë¦¬ë¥¼ ë§ˆë¬´ë¦¬í•˜ê³  ì¸¡ì • ê²°ê³¼ë¥¼ ê³µì‹ì ìœ¼ë¡œ ê¸°ë¡í•˜ì—¬ í›„ì† ê°„í˜¸ì— í™œìš©í•©ë‹ˆë‹¤."}
        ];

        // --- ì˜¤ë””ì˜¤ ì¬ìƒ ìƒíƒœ ë³€ìˆ˜ ---
        let audioPlayer = null; 
        let currentPlayingIndex = -1; 
        let isSequentialPlay = false; 
        let currentPlaybackRate = 1.0; 

       // LAMP í•µì‹¬ê°„í˜¸ìˆ ê¸° ì˜¤ë””ì˜¤ ë§¤í•‘
       // VITAL_SIGN_CHECKLIST_DATA ìˆœì„œ(index)ì™€ ë™ì¼í•˜ê²Œ ë§¤í•‘
        const AUDIO_URLS = [
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/1.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/2.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/3.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/4.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/5.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/6.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/7.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/8.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/9.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/10.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/11.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/12.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/13.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/14.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/15.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/16.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/17.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/18.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/19.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/20.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/21.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/22.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/23.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/24.mp3',
            'https://raw.githubusercontent.com/PANGyoung/LAMP_2/refs/heads/main/audio/25.mp3',
        ];

        const AUDIO_ASSETS = VITAL_SIGN_CHECKLIST_DATA.map((_, index) => ({
            index,
            url: AUDIO_URLS[index] || ''
        }));

        // --- 1. ì˜¤ë””ì˜¤ ì¬ìƒ ì œì–´ í•¨ìˆ˜ ---
        
        /**
         * í˜„ì¬ ì¬ìƒ ì¤‘ì¸ ì˜¤ë””ì˜¤ë¥¼ ì¤‘ì§€í•˜ê³  ìƒíƒœë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
         */
        function stopCurrentAudio() {
            if (audioPlayer) {
                audioPlayer.pause();
                audioPlayer.currentTime = 0;
            }
            audioPlayer = null;
            currentPlayingIndex = -1;
            isSequentialPlay = false;
            updateAudioUI(-1); // UI ì´ˆê¸°í™”
        }
        window.stopCurrentAudio = stopCurrentAudio;

        /**
         * ì˜¤ë””ì˜¤ ì¬ìƒ ì†ë„ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
         */
        function setPlaybackRate(rate) {
            currentPlaybackRate = parseFloat(rate);
            if (audioPlayer) {
                audioPlayer.playbackRate = currentPlaybackRate;
            }
            const rateSpan = document.getElementById('current-rate');
            if(rateSpan) rateSpan.textContent = `${currentPlaybackRate}x`;
            showMessageBox('ì†ë„ ë³€ê²½', `${currentPlaybackRate}ë°°ì†ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'info');
        }
        window.setPlaybackRate = setPlaybackRate;
        
        /**
         * UIì˜ ì¬ìƒ ë²„íŠ¼ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
         */
        function updateAudioUI(index) {
            // ëª¨ë“  í•­ëª© UI ì´ˆê¸°í™”
            document.querySelectorAll('.audio-control-container').forEach(container => {
                const playBtn = container.querySelector('.single-play-btn');
                const sequentialBtn = container.querySelector('.sequential-play-btn');
                if (playBtn) playBtn.innerHTML = '<i data-lucide="volume-2" class="w-5 h-5"></i>';
                if (sequentialBtn) sequentialBtn.innerHTML = '<i data-lucide="chevrons-right" class="w-5 h-5"></i>';
                container.classList.remove('playing');
            });
            
            // ì „ì²´ ë“£ê¸° ë²„íŠ¼ UI ì—…ë°ì´íŠ¸
            const overallPlayBtn = document.getElementById('overall-play-btn');
            if (overallPlayBtn) {
                 overallPlayBtn.innerHTML = (index !== -1 && isSequentialPlay && index === 0) 
                    ? '<i data-lucide="pause" class="w-5 h-5 mr-2 fill-white"></i> ì „ì²´ ë“£ê¸° ì¤‘ì§€' 
                    : '<i data-lucide="play" class="w-5 h-5 mr-2 fill-white"></i> ì „ì²´ ë“£ê¸°';
            }

            // í˜„ì¬ ì¬ìƒ ì¤‘ì¸ í•­ëª© UI ì—…ë°ì´íŠ¸
            if (index !== -1 && audioPlayer && !audioPlayer.paused) {
                const container = document.getElementById(`audio-control-container-${index}`);
                if (container) {
                    const playBtn = container.querySelector('.single-play-btn');
                    const sequentialBtn = container.querySelector('.sequential-play-btn');
                    
                    container.classList.add('playing');
                    
                    if (isSequentialPlay && sequentialBtn) {
                        sequentialBtn.innerHTML = '<i data-lucide="pause" class="w-5 h-5"></i>';
                    } else if (!isSequentialPlay && playBtn) {
                         playBtn.innerHTML = '<i data-lucide="pause" class="w-5 h-5"></i>';
                    }
                }
            }
            lucide.createIcons();
        }

        /**
         * íŠ¹ì • í•­ëª©ì˜ ì˜¤ë””ì˜¤ë¥¼ ì¬ìƒí•©ë‹ˆë‹¤. (ë‹¨ì¼ ì¬ìƒ ë˜ëŠ” ìˆœì°¨ ì¬ìƒ ì‹œì‘)
         */
        function playAudioItem(index, sequential = false) {
            const asset = AUDIO_ASSETS[index];
            if (!asset) {
                console.error("Audio asset not found for index:", index);
                stopCurrentAudio();
                return;
            }

            // ì •ì§€/ì¬ê°œ ì²˜ë¦¬
            if (audioPlayer && currentPlayingIndex === index) {
                if (audioPlayer.paused) {
                    audioPlayer.play().catch(e => console.error("Audio Play Error:", e));
                } else {
                    audioPlayer.pause();
                }
                updateAudioUI(currentPlayingIndex);
                return;
            }
            
            // ìƒˆë¡œìš´ ì¬ìƒ ì‹œì‘
            stopCurrentAudio(); 
            
            audioPlayer = new Audio(asset.url);
            audioPlayer.playbackRate = currentPlaybackRate;
            currentPlayingIndex = index;
            isSequentialPlay = sequential;

            // ì˜¤ë””ì˜¤ ì¢…ë£Œ ì‹œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            audioPlayer.addEventListener('ended', () => {
                if (isSequentialPlay) {
                    const nextIndex = currentPlayingIndex + 1;
                    if (nextIndex < AUDIO_ASSETS.length) {
                        playAudioItem(nextIndex, true); 
                    } else {
                        stopCurrentAudio();
                        showMessageBox('ì¬ìƒ ì™„ë£Œ', 'ëª¨ë“  í•­ëª©ì˜ ìˆœì°¨ ì¬ìƒì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    }
                } else {
                    stopCurrentAudio();
                }
            });
            
            audioPlayer.addEventListener('pause', () => { updateAudioUI(currentPlayingIndex); });
            audioPlayer.addEventListener('play', () => { updateAudioUI(currentPlayingIndex); });

            audioPlayer.addEventListener('error', (e) => {
                console.error(`Error loading/playing audio for index ${index}:`, e);
                stopCurrentAudio();
                showMessageBox('ì˜¤ë””ì˜¤ ì—ëŸ¬', 'MP3 íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (ê²½ë¡œ í™•ì¸ í•„ìš”)', 'error');
            });

            audioPlayer.play().catch(e => {
                console.error("Audio Play Error (Initial):", e);
                showMessageBox('ìë™ ì¬ìƒ ì œí•œ', 'ë¸Œë¼ìš°ì € ì •ì±…ì— ì˜í•´ ìë™ ì¬ìƒì´ ì œí•œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì¬ìƒ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì‹­ì‹œì˜¤.', 'warning');
                updateAudioUI(-1);
            });
            
            const itemElement = document.getElementById(`checklist-item-div-${index}`);
            if (itemElement) {
                itemElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
        window.playAudioItem = playAudioItem;

        /**
         * 1ë²ˆ í•­ëª©ë¶€í„° ì „ì²´ ìˆœì°¨ ì¬ìƒì„ ì‹œì‘í•˜ê±°ë‚˜ ì¤‘ì§€í•©ë‹ˆë‹¤.
         */
        function toggleOverallPlay() {
            if (audioPlayer && currentPlayingIndex === 0 && isSequentialPlay) {
                stopCurrentAudio();
            } else {
                playAudioItem(0, true);
            }
        }
        window.toggleOverallPlay = toggleOverallPlay;
        
        // --- 2. ë·° ë° ìƒíƒœ ê´€ë¦¬ ---
        
        let currentStep = 1; // ìˆ ê¸° ë‹¨ê³„ í•™ìŠµ íƒ­ìš©
        let fullChecklistState = {};  // ì²´í¬ë¦¬ìŠ¤íŠ¸ ìƒíƒœ ì €ì¥ìš©

        /**
         * ë©”ì¸ í™”ë©´(Welcome, Skill List, Detail)ì„ ì „í™˜í•©ë‹ˆë‹¤.
         */
        function showView(viewId, initialSubView = null) {
            const views = document.querySelectorAll('.app-view-main');
            views.forEach(view => view.classList.add('hidden'));
            const activeView = document.getElementById(viewId);
            if (activeView) {
                activeView.classList.remove('hidden');
                if (viewId === 'skill-list-view') {
                    renderSkillList();
                } else if (viewId === 'procedure-detail-view') {
                    renderSubView(initialSubView || 'overview-view');
                }
            }
            const backButton = document.getElementById('back-to-list-btn');
            if (viewId === 'skill-list-view' || viewId === 'welcome-view') {
                backButton.classList.add('hidden');
            } else {
                backButton.classList.remove('hidden');
            }
            stopCurrentAudio();
        }
        window.showView = showView;
        
        /**
         * ìˆ ê¸° ìƒì„¸ í™”ë©´ ë‚´ì˜ ì„œë¸Œ ë·°(íƒ­)ë¥¼ ì „í™˜í•©ë‹ˆë‹¤.
         */
        function renderSubView(viewId) {
            const views = document.querySelectorAll('.app-view-sub');
            views.forEach(view => {
                view.classList.add('hidden');
                view.classList.remove('flex');
            });
            const activeView = document.getElementById(viewId);
            if (activeView) {
                activeView.classList.remove('hidden');
                activeView.classList.add('flex');
            }
            
            // íƒ­ ë„¤ë¹„ê²Œì´ì…˜ ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('bg-indigo-600', 'text-white', 'shadow-inner');
                link.classList.add('text-indigo-700', 'hover:bg-indigo-100');
            });
            const activeLink = document.querySelector(`.nav-link[data-view="${viewId}"]`);
            if (activeLink) {
                activeLink.classList.add('bg-indigo-600', 'text-white', 'shadow-inner');
                activeLink.classList.remove('text-indigo-700', 'hover:bg-indigo-100');
            }
            
            // íƒ­ë³„ ì½˜í…ì¸  ë Œë”ë§
            if (viewId === 'overview-view') { renderOverviewView(); } 
            else if (viewId === 'procedure-learning-view') { renderProcedureLearningView(); } 
            else if (viewId === 'checklist-view') { renderChecklistView(); } 
            else if (viewId === 'charting-view') { renderChartingView(); } 
            else if (viewId === 'progress-view') { renderProgressView(); } 
            else if (viewId === 'tts-view') { renderTTSView(); }
            
            // ë‹¨ê³„ ë„¤ë¹„ê²Œì´ì…˜ í‘œì‹œ/ìˆ¨ê¹€
            const stepNav = document.getElementById('step-navigation');
            if (viewId === 'procedure-learning-view') {
                stepNav.classList.remove('hidden');
            } else {
                stepNav.classList.add('hidden');
            }
            stopCurrentAudio();
        }
        window.renderSubView = renderSubView;

        // --- 3. ë Œë”ë§ í•¨ìˆ˜ ---
        
        /**
         * ìˆ ê¸° ëª©ë¡ í™”ë©´ì„ ë Œë”ë§í•©ë‹ˆë‹¤.
         */
        function renderSkillList() {
            const listContainer = document.getElementById('skill-list-container');
            const html = CORE_SKILLS.map(skill => {
                const isDemo = skill.linkId === 'vital-signs';
                const buttonClass = isDemo ? 'bg-indigo-500 hover:bg-indigo-600' : 'bg-gray-400 cursor-not-allowed';
                const buttonText = isDemo ? 'í•™ìŠµ ì‹œì‘' : 'ê°œë°œ ì˜ˆì •';
                const onClick = isDemo ? `showSkillDetail('${skill.name}')` : `showMessageBox('ì¤€ë¹„ ì¤‘', 'ë‹¤ë¥¸ ìˆ ê¸° í•™ìŠµ ëª¨ë“ˆì€ í˜„ì¬ ê°œë°œ ì˜ˆì •ì…ë‹ˆë‹¤.', 'info')`;
                
                const getDifficultyClass = (d) => {
                    switch (d) {
                        case "í•˜": return "bg-green-100 text-green-700 border-green-300";
                        case "ì¤‘": return "bg-yellow-100 text-yellow-700 border-yellow-300";
                        case "ìƒ": return "bg-red-100 text-red-700 border-red-300";
                        default: return "bg-gray-100 text-gray-700 border-gray-300";
                    }
                };

                return `
                    <div class="skill-item p-4 bg-white rounded-xl shadow-md flex justify-between items-center border border-gray-200">
                        <div class="flex items-center flex-1 min-w-0">
                            <span class="text-3xl mr-3">${skill.emoji}</span>
                            <div>
                                <h3 class="font-semibold text-lg text-gray-800 truncate">${skill.name}</h3>
                                <span class="inline-block mt-1 px-3 py-1 text-xs font-medium rounded-full border ${getDifficultyClass(skill.difficulty)}">
                                    ë‚œì´ë„: ${skill.difficulty}
                                </span>
                            </div>
                        </div>
                        <button onclick="${onClick}" class="ml-4 px-4 py-2 text-sm font-medium text-white rounded-lg ${buttonClass} transition-colors">
                            ${buttonText}
                        </button>
                    </div>
                `;
            }).join('');
            listContainer.innerHTML = html;
        }
        
        function showSkillDetail(skillName) {
            if (skillName === "í™œë ¥ì§•í›„ ì¸¡ì •") {
                showView('procedure-detail-view', 'overview-view');
            } else {
                showMessageBox('ê°œë°œ ì˜ˆì •', `${skillName} í•™ìŠµ ëª¨ë“ˆì€ í˜„ì¬ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.`, 'info');
            }
        }
        window.showSkillDetail = showSkillDetail;

        /**
         * ê°œìš” íƒ­ì„ ë Œë”ë§í•©ë‹ˆë‹¤.
         */
        function renderOverviewView() {
            const view = document.getElementById('overview-view');
            const learningObjectives = [
                "ì²´ì˜¨, ë§¥ë°•, í˜¸í¡, í˜ˆì••ì˜ ê¸°ì „ì„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤.",
                "ì²´ì˜¨, ë§¥ë°•, í˜¸í¡, í˜ˆì••ì„ ì¸¡ì •í•  ìˆ˜ ìˆë‹¤.",
                "ì²´ì˜¨, ë§¥ë°•, í˜¸í¡, í˜ˆì••ì˜ ì¸¡ì • ê²°ê³¼ë¥¼ ê¸°ë¡í•  ìˆ˜ ìˆë‹¤."
            ];
            const prerequisiteKnowledge = [
                "ì²´ì˜¨, ë§¥ë°•, í˜¸í¡, í˜ˆì••ì˜ ì •ì˜ì™€ ì •ìƒë²”ìœ„",
                "ì²´ì˜¨, ë§¥ë°•, í˜¸í¡, í˜ˆì••ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ìš”ì¸"
            ];
            const preparationItems = [
                "ì´ˆì¹¨ì´ ìˆëŠ” ì‹œê³„", "ì „ì ì²´ì˜¨ê³„/ê³ ë§‰ ì²´ì˜¨ê³„(1íšŒìš© íƒì¹¨ ë®ê°œ)",
                "ì•„ë„¤ë¡œì´ë“œ í˜ˆì••ê³„", "ì²­ì§„ê¸°(êµìœ¡ìš© ì²­ì§„ê¸° ì¤€ë¹„)", "ì†ì†Œë…ì œ",
                "ìŸë°˜(Tray), ê³¡ë°˜", "ì†Œë…ì†œ", "ê°„í˜¸ê¸°ë¡ì§€", "ì˜ë£Œíê¸°ë¬¼ ì „ìš©ìš©ê¸°(ì¼ë°˜)"
            ];

            const renderList = (items) => items.map(item => `
                <li class="text-gray-700 mb-2 flex items-start">
                    <span class="mr-2 text-indigo-500 font-bold">â€¢</span>
                    <span class="flex-1">${item}</span>
                </li>
            `).join('');

            const html = `
                <div class="flex flex-col flex-1 items-center justify-center min-h-screen bg-gradient-to-b from-indigo-50 to-white py-10 space-y-10">
                    <div class="text-center mb-4">
                        <h1 class="text-3xl font-extrabold text-gray-800 mb-2 tracking-tight">ğŸ’‰ í™œë ¥ì§•í›„ ì¸¡ì • í•™ìŠµ ê°œìš”</h1>
                        <p class="text-gray-500 text-sm">Vital Signs Measurement Overview</p>
                    </div>
                    <div class="w-full max-w-2xl bg-white rounded-2xl shadow-md hover:shadow-xl transition-shadow p-8">
                        <p class="font-semibold text-gray-800 mb-4 flex items-center justify-center border-b border-indigo-100 pb-2 text-lg">
                            <i data-lucide="target" class="w-6 h-6 mr-2 text-indigo-600"></i> ì„±ì·¨ ëª©í‘œ
                        </p>
                        <ul class="space-y-2 text-base text-gray-700 text-center leading-relaxed">${renderList(learningObjectives)}</ul>
                    </div>
                    <div class="w-full max-w-2xl bg-white rounded-2xl shadow-md hover:shadow-xl transition-shadow p-8">
                        <p class="font-semibold text-gray-800 mb-4 flex items-center justify-center border-b border-green-100 pb-2 text-lg">
                            <i data-lucide="bookmark-check" class="w-6 h-6 mr-2 text-green-600"></i> ì„ í–‰ ì§€ì‹
                        </p>
                        <ul class="space-y-2 text-base text-gray-700 text-center leading-relaxed">${renderList(prerequisiteKnowledge)}</ul>
                    </div>
                    <div class="w-full max-w-2xl bg-white rounded-2xl shadow-md hover:shadow-xl transition-shadow p-8">
                        <p class="font-semibold text-gray-800 mb-4 flex items-center justify-center border-b border-red-100 pb-2 text-lg">
                            <i data-lucide="shopping-bag" class="w-6 h-6 mr-2 text-red-600"></i> ì¤€ë¹„ ë¬¼í’ˆ
                        </p>
                        <ul class="space-y-2 text-base text-gray-700 text-center leading-relaxed">${renderList(preparationItems)}</ul>
                    </div>
                </div>
            `;
            view.innerHTML = html;
            lucide.createIcons();
        }
        window.renderOverviewView = renderOverviewView;

        /**
         * ìˆ ê¸° ë‹¨ê³„ í•™ìŠµ íƒ­ì„ ë Œë”ë§í•˜ê³  ë‹¨ê³„ ë³€ê²½ ê¸°ëŠ¥ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.
         */
        function renderProcedureLearningView() {
            const view = document.getElementById('procedure-learning-view');
            const stepData = VITAL_SIGN_STEPS[currentStep - 1];

            if (!stepData) return;

            const html = `
                <div class="flex flex-col flex-1 p-4 overflow-y-auto">
                    <h3 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2">â–¶ï¸ V/S ${stepData.title}</h3>
                    
                    <!-- ì˜ìƒ ë§í¬ -->
                    <div class="mb-6 p-4 bg-white rounded-xl shadow-md border border-gray-200 text-center">
                        <p class="text-sm mb-3">í™œë ¥ì§•í›„ ì¸¡ì • ì‹¤ìŠµ ì˜ìƒ (QR_11)</p>
                        <a href="${VIDEO_URL}" target="_blank" class="flex items-center justify-center mx-auto px-4 py-2 bg-indigo-600 text-white font-medium rounded-lg hover:bg-indigo-700 transition-colors shadow-md text-sm w-4/5 md:w-1/2">
                            <i data-lucide="monitor-play" class="w-5 h-5 mr-2"></i> ì˜ìƒ ë³´ê¸° (ìƒˆ ì°½ ì—´ë¦¼)
                        </a>
                    </div>

                    <!-- í•µì‹¬ ì ˆì°¨ -->
                    <div class="bg-indigo-50 p-4 rounded-lg mb-6 border-l-4 border-indigo-500 shadow-sm">
                        <p class="font-semibold text-indigo-700 mb-2">í•µì‹¬ ìˆ ê¸° ì ˆì°¨</p>
                        <p class="text-gray-700">${stepData.procedure}</p>
                    </div>

                    <!-- ì„ìƒ íŒ (ë¹„í™œì„±í™”) -->
                    <div class="mb-6">
                        <div class="bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-500 shadow-sm">
                            <p class="font-semibold text-yellow-800 mb-2 flex items-center"><i data-lucide="alert-triangle" class="w-5 h-5 mr-2"></i> ì„ìƒ íŒ</p>
                            <p class="text-yellow-700 text-sm">ì„ìƒ íŒ ìƒì„± ê¸°ëŠ¥ì€ ì¶”í›„ ì¶”ê°€ ì˜ˆì •ì…ë‹ˆë‹¤.</p>
                        </div>
                    </div>

                    <!-- í•µì‹¬ ìš©ì–´ -->
                    <div class="mb-6">
                        <p class="font-semibold text-gray-700 mb-2">í•µì‹¬ ì˜í•™ ìš©ì–´</p>
                        <div class="flex flex-wrap gap-2">
                            ${stepData.terms.map(term => `<span class="px-3 py-1 bg-gray-200 text-gray-700 text-sm rounded-full">${term}</span>`).join('')}
                        </div>
                    </div>
                </div>
            `;
            view.innerHTML = html;
            lucide.createIcons();
        }
        window.renderProcedureLearningView = renderProcedureLearningView;
        
        function changeStep(delta) {
            const newStep = currentStep + delta;
            if (newStep >= 1 && newStep <= VITAL_SIGN_STEPS.length) {
                currentStep = newStep;
                renderProcedureLearningView();
                
                const prevBtn = document.getElementById('prev-step-btn');
                const nextBtn = document.getElementById('next-step-btn');
                const stepSpan = document.getElementById('step-indicator-span');

                stepSpan.textContent = `${currentStep} / ${VITAL_SIGN_STEPS.length}`;
                
                prevBtn.disabled = currentStep === 1;
                prevBtn.classList.toggle('bg-gray-300', currentStep === 1);
                prevBtn.classList.toggle('cursor-not-allowed', currentStep === 1);
                prevBtn.classList.toggle('bg-indigo-500', currentStep !== 1);
                prevBtn.classList.toggle('hover:bg-indigo-600', currentStep !== 1);

                nextBtn.disabled = currentStep === VITAL_SIGN_STEPS.length;
                nextBtn.classList.toggle('bg-gray-300', currentStep === VITAL_SIGN_STEPS.length);
                nextBtn.classList.toggle('cursor-not-allowed', currentStep === VITAL_SIGN_STEPS.length);
                nextBtn.classList.toggle('bg-indigo-500', currentStep !== VITAL_SIGN_STEPS.length);
                nextBtn.classList.toggle('hover:bg-indigo-600', currentStep !== VITAL_SIGN_STEPS.length);
                lucide.createIcons();
            }
        }
        window.changeStep = changeStep;
        
        /**
         * ì²´í¬ë¦¬ìŠ¤íŠ¸ í•­ëª© í† ê¸€ ë° UI ì—…ë°ì´íŠ¸ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.
         */
        function handleChecklistToggle(index) {
            const isChecked = !fullChecklistState[index];
            fullChecklistState[index] = isChecked;

            const checkbox = document.getElementById(`checklist-item-${index}`);
            if (checkbox) { checkbox.checked = isChecked; }

            const parentDiv = document.getElementById(`checklist-item-div-${index}`);
            if (parentDiv) {
                parentDiv.classList.remove('bg-green-50', 'border', 'border-green-300', 'shadow-sm', 'bg-gray-50', 'hover:bg-gray-100', 'border-gray-200');
                if (isChecked) {
                    parentDiv.classList.add('bg-green-50', 'border', 'border-green-300', 'shadow-sm');
                } else {
                    parentDiv.classList.add('bg-gray-50', 'border', 'border-gray-200');
                }
            }

            // ì´ë¡ ì  ê·¼ê±° í‘œì‹œ/ìˆ¨ê¹€
            const rationaleEl = document.getElementById(`rationale-${index}`);
            if (rationaleEl) {
                if (isChecked) {
                    rationaleEl.classList.add('visible');
                    rationaleEl.classList.remove('hidden'); 
                } else {
                    rationaleEl.classList.remove('visible');
                    setTimeout(() => rationaleEl.classList.add('hidden'), 400); 
                }
            }
        }
        window.handleChecklistToggle = handleChecklistToggle;
        
        /**
         * ê°œë³„ í•­ëª© í…ìŠ¤íŠ¸ í† ê¸€ (ì•”ê¸° ëª¨ë“œ) - ìš”ì²­ ë°˜ì˜
         */
        function toggleChecklistItemText(index) {
            const textEl = document.getElementById(`checklist-item-text-${index}`);
            if (textEl) {
                textEl.classList.toggle('blur-sm');
                const iconEl = document.getElementById(`hide-icon-${index}`);
                if (iconEl) {
                    iconEl.innerHTML = textEl.classList.contains('blur-sm')
                        ? '<i data-lucide="eye-off" class="w-5 h-5"></i>'
                        : '<i data-lucide="eye" class="w-5 h-5"></i>';
                    lucide.createIcons();
                }
            }
        }
        window.toggleChecklistItemText = toggleChecklistItemText;

        /**
         * ì „ì²´ í•­ëª© í…ìŠ¤íŠ¸ í† ê¸€ (ì•”ê¸° ëª¨ë“œ) - ìš”ì²­ ë°˜ì˜
         */
        function toggleAllChecklistItemsText() {
            const toggleButton = document.getElementById('toggle-all-checklist-text-btn');
            const isHiding = toggleButton.dataset.state === 'show';
            const items = document.querySelectorAll('.checklist-item-text');

            items.forEach((item, index) => {
                if (isHiding) {
                    item.classList.add('blur-sm');
                } else {
                    item.classList.remove('blur-sm');
                }
                const iconEl = document.getElementById(`hide-icon-${index}`);
                if (iconEl) {
                    iconEl.innerHTML = isHiding
                        ? '<i data-lucide="eye-off" class="w-5 h-5"></i>'
                        : '<i data-lucide="eye" class="w-5 h-5"></i>';
                }
            });

            if (isHiding) {
                toggleButton.dataset.state = 'hide';
                toggleButton.innerHTML = '<i data-lucide="eye" class="w-5 h-5 mr-2"></i> ì „ì²´ í•­ëª© ë³´ì´ê¸°';
                toggleButton.classList.remove('bg-yellow-600', 'hover:bg-yellow-700');
                toggleButton.classList.add('bg-indigo-600', 'hover:bg-indigo-700');
            } else {
                toggleButton.dataset.state = 'show';
                toggleButton.innerHTML = '<i data-lucide="eye-off" class="w-5 h-5 mr-2"></i> ì „ì²´ í•­ëª© ê°€ë¦¬ê¸° (ì•”ê¸° ëª¨ë“œ)';
                toggleButton.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');
                toggleButton.classList.add('bg-yellow-600', 'hover:bg-yellow-700');
            }
            lucide.createIcons();
        }
        window.toggleAllChecklistItemsText = toggleAllChecklistItemsText;
        
        function saveAssessment() {
            const totalItems = VITAL_SIGN_CHECKLIST_DATA.length;
            const completedItems = Object.keys(fullChecklistState).filter(key => fullChecklistState[key]).length;
            const score = Math.round((completedItems / totalItems) * 100);

            showMessageBox('ê¸°ë¡ ì €ì¥ ë¹„í™œì„±í™”', `ì™¸ë¶€ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì´ ì œê±°ë˜ì–´ ê¸°ë¡ì„ ì €ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ì ìˆ˜: ${score}%)`, 'warning');
            const saveBtn = document.querySelector('#checklist-view button[onclick="saveAssessment()"]');
            saveBtn.disabled = false;
            saveBtn.innerHTML = '<i data-lucide="save" class="w-5 h-5 mr-2"></i> í‰ê°€ ê²°ê³¼ ì €ì¥ ë° ì§„ë„ ê¸°ë¡';
            lucide.createIcons();
        }
        window.saveAssessment = saveAssessment;

        /**
         * ì²´í¬ë¦¬ìŠ¤íŠ¸ íƒ­ì„ ë Œë”ë§í•©ë‹ˆë‹¤. (ì˜¤ë””ì˜¤ ì¬ìƒ ê¸°ëŠ¥ ì œê±°, ì•”ê¸° ëª¨ë“œ ì¶”ê°€)
         */
        function renderChecklistView() {
            const view = document.getElementById('checklist-view');
            const totalItems = VITAL_SIGN_CHECKLIST_DATA.length;
            
            let checklistHtml = `
                <div class="flex flex-col flex-1">
                    <h3 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2">âœ… í™œë ¥ì§•í›„ ì¸¡ì • ì „ì²´ ìˆ ê¸° ì²´í¬ë¦¬ìŠ¤íŠ¸ (ì´ ${totalItems} í•­ëª©)</h3>
                    <div class="p-6 bg-white rounded-xl shadow-lg mt-2 border-2 border-indigo-200 flex-1 overflow-y-auto">
                        <p class="text-gray-600 mb-4 font-semibold text-lg">ì „ì²´ ìˆ ê¸° ìˆ˜í–‰ ì ê²€ ë° ì•”ê¸° ëª¨ë“œ</p>
                        <p class="text-sm text-gray-500 mb-4">ìˆ ê¸° í•­ëª©ì„ ì ê²€í•˜ê³  ì•”ê¸° ëª¨ë“œë¡œ ì „í™˜í•˜ì—¬ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìŒì„± ì•ˆë‚´ëŠ” "ìŒì„±" íƒ­ì„ ì´ìš©í•˜ì„¸ìš”.
                        
                        <!-- ì „ì²´ í•­ëª© ê°€ë¦¬ê¸° ë²„íŠ¼ (ì•”ê¸° ëª¨ë“œ) - ìš”ì²­ ë°˜ì˜ -->
                        <button id="toggle-all-checklist-text-btn" data-state="show" onclick="toggleAllChecklistItemsText()" class="w-full flex items-center justify-center mb-6 px-4 py-3 text-base font-medium rounded-xl shadow-md text-white bg-yellow-600 hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 transition-colors">
                            <i data-lucide="eye-off" class="w-5 h-5 mr-2"></i> ì „ì²´ í•­ëª© ê°€ë¦¬ê¸° (ì•”ê¸° ëª¨ë“œ)
                        </button>

                        <div class="space-y-4">
            `;
            
            VITAL_SIGN_CHECKLIST_DATA.forEach((data, index) => {
                const isChecked = fullChecklistState[index] || false;
                const checkboxState = isChecked ? 'checked' : '';
                const divClass = isChecked ? 'bg-green-50 border border-green-300 shadow-sm' : 'bg-gray-50 border border-gray-200';

                checklistHtml += `
                            <div id="checklist-item-div-${index}" class="p-4 rounded-lg transition-all cursor-default ${divClass}">
                                <div class="flex items-start justify-between">
                                    <!-- ì²´í¬ë¦¬ìŠ¤íŠ¸ í•­ëª© í…ìŠ¤íŠ¸ ë° í† ê¸€ ì˜ì—­ -->
                                    <div class="flex items-start flex-1 cursor-pointer transition-colors" onclick="handleChecklistToggle(${index})">
                                        <input type="checkbox" id="checklist-item-${index}" class="mt-1 mr-3 w-5 h-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500 focus:border-indigo-500 cursor-pointer" ${checkboxState} onclick="event.stopPropagation(); handleChecklistToggle(${index})">
                                        <label for="checklist-item-${index}" id="checklist-item-text-${index}" class="checklist-item-text text-sm font-medium text-gray-900 flex-1 transition-colors cursor-pointer">
                                            ${index + 1}. ${data.item}
                                        </label>
                                    </div>
                                    <!-- ì˜¤ë””ì˜¤ ì»¨íŠ¸ë¡¤ ë²„íŠ¼ ì˜ì—­ -->
                                    <div id="audio-control-container-${index}" class="audio-control-container flex-shrink-0 flex items-center space-x-2 ml-4">
                                        <!-- ë‹¨ì¼ ì¬ìƒ ë²„íŠ¼ -->
                                        <button onclick="event.stopPropagation(); playAudioItem(${index}, false);" 
                                                class="single-play-btn p-2 text-indigo-500 hover:bg-indigo-100 rounded-full transition-colors" title="ë‹¨ì¼ í•­ëª© ì¬ìƒ/ì •ì§€">
                                            <i data-lucide="volume-2" class="w-5 h-5"></i>
                                        </button>
                                        <!-- ìˆœì°¨ ì¬ìƒ ë²„íŠ¼ -->
                                        <button onclick="event.stopPropagation(); playAudioItem(${index}, true);" 
                                                class="sequential-play-btn p-2 text-indigo-500 hover:bg-indigo-100 rounded-full transition-colors" title="ì´ í•­ëª©ë¶€í„° ìˆœì°¨ ì¬ìƒ/ì •ì§€">
                                            <i data-lucide="chevrons-right" class="w-5 h-5"></i>
                                        </button>
                                        
                                        <!-- í•­ëª© ìˆ¨ê¸°ê¸°/ë³´ì´ê¸° ë²„íŠ¼ - ìš”ì²­ ë°˜ì˜ -->
                                        <button onclick="event.stopPropagation(); toggleChecklistItemText(${index});" 
                                                class="text-yellow-600 hover:text-yellow-800 p-2 rounded-full hover:bg-yellow-100 transition-colors" title="í•­ëª© í…ìŠ¤íŠ¸ ìˆ¨ê¸°ê¸°/ë³´ì´ê¸°">
                                            <span id="hide-icon-${index}"><i data-lucide="eye" class="w-5 h-5"></i></span>
                                        </button>

                                        <!-- ì´ë¡ ì  ê·¼ê±°/ë©”ëª¨ ë³´ê¸° ë²„íŠ¼ -->
                                        <button onclick="event.stopPropagation(); 
                                                         const r = document.getElementById('rationale-${index}'); r.classList.toggle('visible'); r.classList.toggle('hidden');
                                                         const m = document.getElementById('memo-container-${index}'); m.classList.toggle('visible'); m.classList.toggle('hidden');
                                                         lucide.createIcons();" 
                                                class="text-indigo-500 hover:text-indigo-700 font-semibold flex items-center rounded-full hover:bg-indigo-100" title="ì´ë¡ ì  ê·¼ê±° / ë©”ëª¨ ë³´ê¸°">
                                            <span class="text-lg flex items-center justify-center" style="width: 20px; height: 20px;">ğŸ“</span>
                                        </button>
                                    </div>
                                </div>
                                <!-- ì´ë¡ ì  ê·¼ê±° (Rationale) -->
                                <div id="rationale-${index}" class="rationale-container pt-2 px-1 hidden">
                                    <p class="text-xs italic text-green-700"><b>ì´ë¡ ì  ê·¼ê±°:</b> ${data.rationale}</p>
                                </div>
                                <!-- ë©”ëª¨ ì…ë ¥ ì˜ì—­ -->
                                <div id="memo-container-${index}" class="rationale-container pt-2 px-1 hidden">
                                    <label for="memo-${index}" class="text-xs font-semibold text-gray-700">ë©”ëª¨:</label>
                                    <textarea id="memo-${index}" onclick="event.stopPropagation();" class="mt-1 w-full text-xs p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500" rows="2" placeholder="ì´ í•­ëª©ì— ëŒ€í•œ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                                </div>
                            </div>
                `;
            });

            checklistHtml += `
                        </div>
                        <button onclick="saveAssessment()" class="w-full mt-6 flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-xl shadow-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            <i data-lucide="save" class="w-5 h-5 mr-2"></i> í‰ê°€ ê²°ê³¼ ì €ì¥ ë° ì§„ë„ ê¸°ë¡
                        </button>
                    </div>
                </div>
            `;
            view.innerHTML = checklistHtml;
            updateAudioUI(currentPlayingIndex); 
            lucide.createIcons();
            
            // ì „ì²´ ê°€ë¦¬ê¸° ë²„íŠ¼ì˜ ì´ˆê¸° ìƒíƒœ ì„¤ì •
            const initialToggleBtn = document.getElementById('toggle-all-checklist-text-btn');
            if (initialToggleBtn && initialToggleBtn.dataset.state === 'hide') {
                toggleAllChecklistItemsText(); // ìƒíƒœê°€ hideì˜€ë‹¤ë©´ ë‹¤ì‹œ showë¡œ ëŒë¦¬ë©´ì„œ UIë¥¼ ì´ˆê¸°í™” (ë²„íŠ¼ í…ìŠ¤íŠ¸ ë•Œë¬¸ì— í˜¸ì¶œ)
            } else if (initialToggleBtn) {
                 // ìµœì´ˆ ë¡œë“œ ì‹œ ì•„ì´ì½˜ ë Œë”ë§
                 lucide.createIcons();
            }
        }
        window.renderChecklistView = renderChecklistView;
        
        /**
         * ìŒì„± íƒ­ (ì¬ìƒ ì†ë„ ì¡°ì ˆ ë° ì „ì²´ ë“£ê¸°)ì„ ë Œë”ë§í•©ë‹ˆë‹¤. - ìš”ì²­ ë°˜ì˜
         */
        function renderTTSView() {
            const view = document.getElementById('tts-view');
            const speedOptions = [
                { rate: 0.75, label: "ëŠë¦¬ê²Œ (0.75x)" },
                { rate: 1.0, label: "í‘œì¤€ (1.0x)" },
                { rate: 1.25, label: "ì¡°ê¸ˆ ë¹ ë¥´ê²Œ (1.25x)" },
                { rate: 1.5, label: "ë¹ ë¥´ê²Œ (1.5x)" },
                { rate: 2.0, label: "ë§¤ìš° ë¹ ë¥´ê²Œ (2.0x)" }
            ];
            
            const optionsHtml = speedOptions.map(option => `
                <option value="${option.rate}" ${currentPlaybackRate === option.rate ? 'selected' : ''}>${option.label}</option>
            `).join('');
            
            view.innerHTML = `
                <div class="flex flex-col flex-1 p-4 overflow-y-auto items-center justify-center">
                    <div class="text-center max-w-md w-full p-8 bg-white rounded-2xl shadow-lg border border-indigo-100">
                        <h3 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2 flex items-center justify-center">
                            <i data-lucide="volume-2" class="w-6 h-6 mr-2 text-indigo-600"></i>
                            ìŒì„± ì•ˆë‚´ ë° ì „ì²´ ë“£ê¸° ì œì–´ _ CLOVA Dubbingì˜ AI ë³´ì´ìŠ¤ë¡œ ì œì‘í•˜ì˜€ìŠµë‹ˆë‹¤.
                        </h3>
                        
                        <!-- ì „ì²´ ë“£ê¸° ë²„íŠ¼ (ì²´í¬ë¦¬ìŠ¤íŠ¸ì—ì„œ ì´ë™ë¨) -->
                        <button id="overall-play-btn" onclick="toggleOverallPlay()" class="w-full flex items-center justify-center mb-6 px-4 py-3 text-base font-medium rounded-xl shadow-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors">
                            <i data-lucide="play" class="w-5 h-5 mr-2 fill-white"></i> ì „ì²´ ë“£ê¸°
                        </button>
                        
                        <p class="text-gray-600 mb-6 text-sm">
                            ì²´í¬ë¦¬ìŠ¤íŠ¸ì—ì„œ ì¬ìƒë˜ëŠ” ëª¨ë“  ì˜¤ë””ì˜¤ íŒŒì¼ì˜ ì†ë„ë¥¼ ì¡°ì ˆí•©ë‹ˆë‹¤.
                        </p>
                        
                        <!-- ì†ë„ ì¡°ì ˆ ì„ íƒ -->
                        <div class="mb-4">
                            <label for="playback-rate-select" class="block text-sm font-medium text-gray-700 mb-2">ì¬ìƒ ì†ë„ ì„ íƒ:</label>
                            <select id="playback-rate-select" onchange="setPlaybackRate(this.value)" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md shadow-md">
                                ${optionsHtml}
                            </select>
                        </div>

                        <!-- í˜„ì¬ ìƒíƒœ -->
                        <div class="mt-8 p-3 bg-indigo-50 rounded-lg text-sm text-indigo-700 font-medium">
                            í˜„ì¬ ì¬ìƒ ì†ë„: <span id="current-rate">${currentPlaybackRate}x</span>
                        </div>
                    </div>
                </div>
            `;
            const rateSpan = document.getElementById('current-rate');
            if(rateSpan) rateSpan.textContent = `${currentPlaybackRate}x`;
            
            updateAudioUI(currentPlayingIndex); // ì „ì²´ ë“£ê¸° ë²„íŠ¼ UI ìƒíƒœ ì—…ë°ì´íŠ¸
            lucide.createIcons();
        }
        window.renderTTSView = renderTTSView;

        /**
         * ê°„í˜¸ ê¸°ë¡ ì´ˆì•ˆ íƒ­ (ë¹„í™œì„±í™”)ì„ ë Œë”ë§í•©ë‹ˆë‹¤.
         */
         function renderChartingView() {
            const view = document.getElementById('charting-view');
            view.innerHTML = `
                <div class="flex flex-col flex-1 p-4 overflow-y-auto">
                    <h3 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2">âœ¨ ê°„í˜¸ ê¸°ë¡ ì´ˆì•ˆ ìƒì„±ê¸° - AIë°”íƒ•ìœ¼ë¡œ ìƒì„±ëœ ë‚´ìš©ìœ¼ë¡œ ì‚¬ìš©ì‹œ ì£¼ì˜</h3>
                    <p class="text-gray-600 mb-6">í™œë ¥ì§•í›„ì™€ í™˜ìì˜ ìƒíƒœë¥¼ ì…ë ¥í•˜ë©´, ì„ìƒì  íŒë‹¨ì— ê¸°ë°˜í•œ **ê°„í˜¸ ê¸°ë¡(Charting Note)** ì´ˆì•ˆì„ ìƒì„±í•´ ë“œë¦½ë‹ˆë‹¤.</p>

                    <div class="space-y-4 mb-8 p-6 bg-white rounded-xl shadow-lg border border-gray-100">
                        <div class="grid grid-cols-2 gap-4">
                            <label class="block">
                                <span class="text-gray-700 font-medium">ì²´ì˜¨ (T, Â°C)</span>
                                <input id="chart-t" type="number" step="0.1" placeholder="36.5" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                            </label>
                            <label class="block">
                                <span class="text-gray-700 font-medium">ë§¥ë°• (P, íšŒ/ë¶„)</span>
                                <input id="chart-p" type="number" placeholder="72" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                            </label>
                            <label class="block">
                                <span class="text-gray-700 font-medium">í˜¸í¡ (R, íšŒ/ë¶„)</span>
                                <input id="chart-r" type="number" placeholder="18" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                            </label>
                            <label class="block">
                                <span class="text-gray-700 font-medium">í˜ˆì•• (BP, mmHg)</span>
                                <input id="chart-bp" type="text" placeholder="120/80" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                            </label>
                        </div>
                        
                        <label class="block pt-2">
                            <span class="text-gray-700 font-medium">í™˜ì ì£¼ìš” ì¦ìƒ ë° ê°ê´€ì /ì£¼ê´€ì  ìƒíƒœ (í•„ìˆ˜)</span>
                            <textarea id="chart-symptoms" rows="3" placeholder="ì˜ˆ: 'ë‘í†µ í˜¸ì†Œ', 'ì‹ì€ë•€ í˜ë¦¼', 'ì˜ì‹ ëª…ë£Œí•¨' ë“±" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"></textarea>
                        </label>

                        <button onclick="generateChartingNote()" id="charting-btn" class="w-full flex items-center justify-center px-4 py-3 text-base font-bold rounded-xl text-white bg-indigo-600 hover:bg-indigo-700 transition-colors shadow-md mt-4">
                            <i data-lucide="bot" class="w-5 h-5 mr-2"></i> ê¸°ë¡ ì´ˆì•ˆ ìƒì„±
                        </button>
                    </div>

                    <h3 class="text-lg font-bold text-gray-700 mb-3">ìƒì„±ëœ ê°„í˜¸ ê¸°ë¡ ì´ˆì•ˆ</h3>
                    <div id="charting-output" class="p-4 bg-gray-100 rounded-lg min-h-[150px] shadow-inner text-gray-700">
                        <p class="text-gray-500 italic text-sm">ê¸°ë¡ ì´ˆì•ˆì„ ìƒì„±í•˜ë ¤ë©´ ìœ„ì˜ ì–‘ì‹ì„ ì‘ì„±í•˜ê³  ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }
        window.renderChartingView = renderChartingView;

        /**
         * (ì‚¬ìš©ì ìš”ì²­) Gemini APIë¥¼ ì§€ìˆ˜ ë°±ì˜¤í”„ ë°©ì‹ìœ¼ë¡œ í˜¸ì¶œí•©ë‹ˆë‹¤.
         */
        async function fetchGeminiContent(userQuery, systemPrompt, maxRetries = 3) {
            const apiKey = API_KEY; 
            const url = `${API_URL}?key=${apiKey}`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };

            for (let attempt = 0; attempt < maxRetries; attempt++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        if (response.status === 429 && attempt < maxRetries - 1) {
                            const delay = Math.pow(2, attempt) * 1000; 
                            await new Promise(resolve => setTimeout(resolve, delay));
                            continue; 
                        }
                        throw new Error(`API call failed with status: ${response.status}`);
                    }

                    const result = await response.json();
                    const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    
                    if (text) {
                        return text; 
                    } else {
                        throw new Error("API response text is empty or malformed.");
                    }
                } catch (error) {
                    console.error(`Attempt ${attempt + 1} failed:`, error);
                    if (attempt === maxRetries - 1) throw error; 
                    const delay = Math.pow(2, attempt) * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }
        }

        async function generateChartingNote() {
            const t = document.getElementById('chart-t').value;
            const p = document.getElementById('chart-p').value;
            const r = document.getElementById('chart-r').value;
            const bp = document.getElementById('chart-bp').value;
            const symptoms = document.getElementById('chart-symptoms').value;
            const output = document.getElementById('charting-output');
            const button = document.getElementById('charting-btn');

            if (!symptoms) {
                showMessageBox('ì…ë ¥ ë¶€ì¡±', 'í™˜ìì˜ ì£¼ìš” ì¦ìƒ ë° ìƒíƒœë¥¼ ë°˜ë“œì‹œ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.', 'warning');
                return;
            }

            button.disabled = true;
            button.innerHTML = '<i data-lucide="loader" class="w-5 h-5 mr-2 animate-spin"></i> ì´ˆì•ˆ ìƒì„± ì¤‘...';
            output.innerHTML = '<p class="text-gray-500 italic text-sm">Geminiê°€ ì „ë¬¸ì ì¸ ê°„í˜¸ ê¸°ë¡ ì´ˆì•ˆì„ ì‘ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>';
            lucide.createIcons();

            const vts = `ì²´ì˜¨(T): ${t || 'ê¸°ë¡ ì—†ìŒ'}Â°C, ë§¥ë°•(P): ${p || 'ê¸°ë¡ ì—†ìŒ'}íšŒ/ë¶„, í˜¸í¡(R): ${r || 'ê¸°ë¡ ì—†ìŒ'}íšŒ/ë¶„, í˜ˆì••(BP): ${bp || 'ê¸°ë¡ ì—†ìŒ'} mmHg`;

            const systemPrompt = "You are a professional registered nurse. Your task is to generate a concise, objective, and well-structured nursing note (Charting Note) based on the provided vital signs and patient symptoms. Use the DAR (Data, Action, Response) format, making it clear and clinically relevant. Use Korean for the final output. Do not include a time or date placeholder or your signature. Just provide the note content.";
            const userQuery = `ë‹¤ìŒ í™˜ì ë°ì´í„°ì— ëŒ€í•´ ê°„í˜¸ ê¸°ë¡ ì´ˆì•ˆì„ ì‘ì„±í•´ ì£¼ì„¸ìš”. ì „ë¬¸ ê°„í˜¸ì‚¬ì²˜ëŸ¼ ì‘ì„±í•˜ê³ , í•„ìš”í•œ ê²½ìš° í›„ì† ì¡°ì¹˜(Plan/Action)ë¥¼ ì œì‹œí•´ì£¼ì„¸ìš”.\n\ní™œë ¥ì§•í›„: ${vts}\nì£¼ìš” ì¦ìƒ ë° ìƒíƒœ: ${symptoms}`;

            try {
                const note = await fetchGeminiContent(userQuery, systemPrompt);
                output.innerHTML = `
                    <div class="text-sm bg-white p-4 rounded-lg border border-indigo-200 whitespace-pre-wrap font-mono">
                        ${note}
                    </div>
                `;
            } catch (error) {
                output.innerHTML = '<p class="text-red-500">ê¸°ë¡ ì´ˆì•ˆ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.</p>';
            } finally {
                button.disabled = false;
                button.innerHTML = '<i data-lucide="bot" class="w-5 h-5 mr-2"></i> ê¸°ë¡ ì´ˆì•ˆ ìƒì„±';
                lucide.createIcons();
            }
        }
        window.generateChartingNote = generateChartingNote;
        /**
         * í•™ìŠµ ì§„ë„ íƒ­ (ë¹„í™œì„±í™”)ì„ ë Œë”ë§í•©ë‹ˆë‹¤.
         */
        function renderProgressView() {
            const listEl = document.getElementById('progress-list');
            const totalScoreEl = document.getElementById('average-score');
            const progressChartEl = document.getElementById('overall-progress-chart');

            listEl.innerHTML = '<div class="p-6 text-center text-gray-500 bg-white rounded-xl shadow-sm">í•™ìŠµ ê¸°ë¡ ì €ì¥ ê¸°ëŠ¥ì´ ì œê±°ë˜ì–´ ì§„ë„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
            totalScoreEl.textContent = '0%';
            progressChartEl.style.width = '0%';
        }
        
        // --- 4. ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ (ë©”ì‹œì§€ ë°•ìŠ¤) ---
        
        function showMessageBox(title, message, type = 'info') {
            const box = document.getElementById('message-box');
            const titleEl = document.getElementById('message-title');
            const messageEl = document.getElementById('message-text');
            const iconEl = document.getElementById('message-icon');
            const closeBtn = document.getElementById('message-close-btn');

            let bgColor, icon;
            switch (type) {
                case 'success':
                    bgColor = 'bg-green-500'; icon = 'check-circle'; break;
                case 'warning':
                    bgColor = 'bg-yellow-500'; icon = 'alert-triangle'; break;
                case 'error':
                    bgColor = 'bg-red-500'; icon = 'x-octagon'; break;
                case 'info':
                default:
                    bgColor = 'bg-indigo-500'; icon = 'info'; break;
            }

            box.className = `fixed top-4 right-4 z-50 flex items-center justify-between text-white p-4 rounded-lg shadow-xl ${bgColor}`;
            titleEl.textContent = title;
            messageEl.textContent = message;
            iconEl.innerHTML = `<i data-lucide="${icon}" class="w-6 h-6 mr-3"></i>`;
            box.classList.remove('hidden');

            setTimeout(() => { box.classList.add('hidden'); }, 5000);
            closeBtn.onclick = () => box.classList.add('hidden');
            lucide.createIcons();
        }
        window.showMessageBox = showMessageBox;

        // --- ì´ˆê¸°í™” ---
        document.addEventListener('DOMContentLoaded', () => { showView('welcome-view'); });
    </script>
</head>
<body class="min-h-screen p-4 sm:p-6 pb-20">
    <!-- ë©”ì‹œì§€ ë°•ìŠ¤ (alert() ëŒ€ì²´) -->
    <div id="message-box" class="fixed top-4 right-4 z-50 hidden items-center justify-between text-white p-4 rounded-lg shadow-xl" role="alert">
        <div class="flex items-center">
            <span id="message-icon" class="flex-shrink-0"></span>
            <div>
                <p id="message-title" class="font-bold text-sm"></p>
                <p id="message-text" class="text-sm"></p>
            </div>
        </div>
        <button id="message-close-btn" class="ml-4 p-1 rounded-full hover:bg-white hover:bg-opacity-20 transition-colors">
            <i data-lucide="x" class="w-4 h-4"></i>
        </button>
    </div>

    <div class="container relative min-h-screen" id="app-container">
        <!-- ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸° ë²„íŠ¼ -->
        <button id="back-to-list-btn" onclick="showView('skill-list-view')" class="hidden fixed top-4 left-4 sm:left-6 z-20 flex items-center px-4 py-2 text-sm font-medium rounded-full text-white bg-indigo-600 hover:bg-indigo-700 transition-colors shadow-lg">
            <i data-lucide="chevron-left" class="w-5 h-5 mr-1"></i> ëª©ë¡ìœ¼ë¡œ
        </button>

        <!-- ë©”ì¸ ë·°: 1. í™˜ì˜ í™”ë©´ -->
        <div id="welcome-view" class="app-view-main flex justify-center items-center min-h-screen text-center p-4">
            <div class="w-full max-w-md">
                <div class="p-8 bg-white rounded-3xl shadow-2xl border border-indigo-100">
                    <div class="mb-8">
                        <i data-lucide="graduation-cap" class="w-16 h-16 mx-auto text-indigo-600 mb-4"></i>
                        <h2 class="text-4xl font-extrabold text-indigo-800 mb-2">LAMP</h2>
                        <p class="text-xl font-medium text-gray-700 mb-6">
                            <span class="font-mono text-indigo-600">(L)</span>earning <span class="font-mono text-indigo-600">(A)</span>ssistant for <span class="font-mono text-indigo-600">(M)</span>edical <span class="font-mono text-indigo-600">(P)</span>ractice
                        </p>
                        <p class="text-gray-600 italic mb-8">
                            "ê°„í˜¸ ì§€ì‹ì˜ ë¹›ì„ ë°íˆëŠ” í•™ìŠµ ë„ìš°ë¯¸"
                        </p>
                    </div>
                    <button onclick="showView('skill-list-view')" class="start-button flex items-center justify-center mx-auto px-8 py-4 text-lg font-bold rounded-full text-white bg-indigo-600 hover:bg-indigo-700 transition-colors shadow-lg">
                        <i data-lucide="play" class="w-6 h-6 mr-2 fill-white"></i> í•™ìŠµ ì‹œì‘í•˜ê¸°
                    </button>
                    <!-- ë¡œê·¸ì¸ UI (ê¸°ëŠ¥ ë¹„í™œì„±í™”) -->
                    <div class="mt-8 text-left">
                        <h3 class="text-indigo-700 font-semibold text-lg mb-3">ë¡œê·¸ì¸ (ë¹„í™œì„±í™”ë¨)</h3>
                        <form onsubmit="event.preventDefault(); showMessageBox('ê¸°ëŠ¥ ì œê±°', 'ì¸ì¦ ê¸°ëŠ¥ì´ ì œê±°ë˜ì–´ ë¡œê·¸ì¸ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.', 'error')" class="space-y-4">
                            <input type="email" placeholder="ì´ë©”ì¼" disabled class="w-full p-3 border border-indigo-200 rounded-xl focus:outline-none bg-gray-100" />
                            <input type="password" placeholder="ë¹„ë°€ë²ˆí˜¸" disabled class="w-full p-3 border border-indigo-200 rounded-xl focus:outline-none bg-gray-100" />
                            <button type="submit" disabled class="w-full bg-gray-400 text-white font-semibold py-3 rounded-xl cursor-not-allowed"> ë¡œê·¸ì¸ </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- ë©”ì¸ ë·°: 2. ìˆ ê¸° ëª©ë¡ í™”ë©´ -->
        <div id="skill-list-view" class="app-view-main hidden pt-12">
            <h2 class="text-3xl font-extrabold text-gray-800 mb-6 flex items-center">
                <i data-lucide="list-checks" class="w-8 h-8 mr-2 text-indigo-600"></i> í•µì‹¬ ê°„í˜¸ ìˆ ê¸° ëª©ë¡
            </h2>
            <div id="skill-list-container" class="space-y-4">
                <!-- ìˆ ê¸° ëª©ë¡ì´ ì—¬ê¸°ì— ë Œë”ë§ë©ë‹ˆë‹¤ -->
            </div>
        </div>

        <!-- ë©”ì¸ ë·°: 3. ìˆ ê¸° ìƒì„¸ í™”ë©´ -->
        <div id="procedure-detail-view" class="app-view-main hidden pt-12 flex flex-col min-h-[80vh]">
            <h2 class="text-2xl font-extrabold text-gray-800 mb-4 flex items-center">
                <i data-lucide="stethoscope" class="w-6 h-6 mr-2 text-indigo-600"></i>
                <span id="skill-detail-title">í™œë ¥ì§•í›„ ì¸¡ì •</span>
                <span id="user-id-display" class="text-xs font-medium text-gray-500 ml-3"></span>
            </h2>

            <!-- ì„œë¸Œ ë„¤ë¹„ê²Œì´ì…˜ (íƒ­) -->
            <nav class="fixed bottom-0 left-0 right-0 bg-white border-t sm:relative sm:border-t-0 sm:flex sm:justify-center sm:mb-8 z-10">
                <div class="flex justify-around w-full sm:w-auto sm:space-x-2 p-2 sm:p-0 text-sm font-medium">
                    <button class="nav-link flex-1 sm:flex-initial flex flex-col items-center p-2 rounded-xl text-indigo-700 hover:bg-indigo-100 transition-colors" data-view="overview-view" onclick="renderSubView('overview-view')">
                        <i data-lucide="layout-grid" class="w-6 h-6"></i><span class="text-xs mt-1">ê°œìš”</span>
                    </button>
                    <button class="nav-link flex-1 sm:flex-initial flex flex-col items-center p-2 rounded-xl text-indigo-700 hover:bg-indigo-100 transition-colors" data-view="procedure-learning-view" onclick="renderSubView('procedure-learning-view')">
                        <i data-lucide="book-open-text" class="w-6 h-6"></i><span class="text-xs mt-1">ìˆ ê¸° ë‹¨ê³„</span>
                    </button>
                    <button class="nav-link flex-1 sm:flex-initial flex flex-col items-center p-2 rounded-xl text-indigo-700 hover:bg-indigo-100 transition-colors" data-view="checklist-view" onclick="renderSubView('checklist-view')">
                        <i data-lucide="clipboard-check" class="w-6 h-6"></i><span class="text-xs mt-1">ì²´í¬ë¦¬ìŠ¤íŠ¸</span>
                    </button>
                    <button class="nav-link flex-1 sm:flex-initial flex flex-col items-center p-2 rounded-xl text-indigo-700 hover:bg-indigo-100 transition-colors" data-view="tts-view" onclick="renderSubView('tts-view')">
                        <i data-lucide="volume-2" class="w-6 h-6"></i><span class="text-xs mt-1">ìŒì„±</span>
                    </button>
                    <button class="nav-link flex-1 sm:flex-initial flex flex-col items-center p-2 rounded-xl text-indigo-700 hover:bg-indigo-100 transition-colors" data-view="charting-view" onclick="renderSubView('charting-view')">
                        <i data-lucide="message-square-text" class="w-6 h-6"></i><span class="text-xs mt-1">ê¸°ë¡ ì´ˆì•ˆ</span>
                    </button>
                    <button class="nav-link flex-1 sm:flex-initial flex flex-col items-center p-2 rounded-xl text-indigo-700 hover:bg-indigo-100 transition-colors" data-view="progress-view" onclick="renderSubView('progress-view')">
                        <i data-lucide="trending-up" class="w-6 h-6"></i><span class="text-xs mt-1">í•™ìŠµ ì§„ë„</span>
                    </button>
                </div>
            </nav>

            <!-- ì„œë¸Œ ë·° ì½˜í…ì¸  ì˜ì—­ -->
            <div class="flex-1 bg-white rounded-xl shadow-lg border border-gray-200 p-0 mb-20 sm:mb-0 overflow-hidden">
                <div id="overview-view" class="app-view-sub flex-col hidden min-h-[400px] overflow-y-auto"></div>
                <div id="procedure-learning-view" class="app-view-sub flex-col hidden min-h-[400px] overflow-hidden"></div>
                <div id="checklist-view" class="app-view-sub flex-col hidden min-h-[400px]"></div>
                <div id="tts-view" class="app-view-sub flex-col hidden min-h-[400px]"></div>
                <div id="charting-view" class="app-view-sub flex-col hidden min-h-[400px]"></div>
                <div id="progress-view" class="app-view-sub flex-col hidden min-h-[400px] p-4 overflow-y-auto">
                    <h3 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2">í™œë ¥ì§•í›„ ì¸¡ì • í•™ìŠµ ì§„ë„ (ë¹„í™œì„±í™”ë¨)</h3>
                    <div class="bg-indigo-50 p-6 rounded-xl shadow-inner mb-6">
                        <p class="text-lg font-semibold text-indigo-700 mb-2">ì´ í‰ê°€ í‰ê·  ì ìˆ˜</p>
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm text-indigo-600 font-medium"> í‰ê·  ì ìˆ˜:</span>
                            <span id="average-score" class="text-xl font-bold text-indigo-800">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3">
                            <div id="overall-progress-chart" class="progress-bar-fill h-3 bg-indigo-500 rounded-full" style="width: 0%"></div>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">ì €ì¥ëœ ê¸°ë¡ ì—†ìŒ</p>
                    </div>
                    <div id="progress-list" class="space-y-3"></div>
                </div>
            </div>

            <!-- ë‹¨ê³„ ë„¤ë¹„ê²Œì´ì…˜ (ìˆ ê¸° ë‹¨ê³„ íƒ­ì—ì„œë§Œ ë³´ì„) -->
            <div id="step-navigation" class="flex justify-center items-center py-4 border-t hidden">
                <button id="prev-step-btn" class="flex items-center justify-center px-4 py-2 text-sm font-medium rounded-lg text-white bg-gray-300 cursor-not-allowed" disabled onclick="changeStep(-1)">
                    <i data-lucide="chevron-left" class="w-5 h-5 mr-1"></i> ì´ì „ ë‹¨ê³„
                </button>
                <span id="step-indicator-span" class="text-indigo-800 font-semibold mx-4">1 / 6</span>
                <button id="next-step-btn" class="flex items-center justify-center px-4 py-2 text-sm font-medium rounded-lg text-white bg-indigo-500 hover:bg-indigo-600 transition-colors" onclick="changeStep(1)">
                    ë‹¤ìŒ ë‹¨ê³„ <i data-lucide="chevron-right" class="w-5 h-5 ml-1"></i>
                </button>
            </div>
        </div>

        <!-- ëª¨ë°”ì¼ í•˜ë‹¨ ì—¬ë°±ìš© -->
        <div class="h-16 sm:h-0"></div>
    </div>
</body>
</html>